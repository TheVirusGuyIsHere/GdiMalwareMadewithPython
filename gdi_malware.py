import time
import random
import platform
import pygame
import bytebeat
import sound_generator

# Set the duration of the malware (in seconds)
DURATION = 5 * 60

# Set the flag to stop the program gracefully
stop_flag = False

# Initialize Pygame
pygame.init()

# Get the screen size
screen_width, screen_height = pygame.display.get_desktop_sizes()[0]

# Create the screen
screen = pygame.display.set_mode((screen_width, screen_height), pygame.FULLSCREEN)

# Initialize the sound generator
sound_generator.init()

# Set the random seed for the random number generator
random.seed()

# Define the main loop
def main_loop():
    global stop_flag

    # Initialize the random seed for the random number generator
    random.seed(int(time.time()))

    # Loop until the stop flag is set
    while not stop_flag:
        # Generate random shapes and colors
        shape = random.choice(["rectangle", "ellipse"])
        x, y = random.randint(0, screen_width), random.randint(0, screen_height)
        width, height = random.randint(0, screen_width // 2), random.randint(0, screen_height // 2)
        color = (random.randint(0, 255), random.randint(0, 255), random.randint(0, 255))

        # Draw the shape on the screen
        if shape == "rectangle":
            pygame.draw.rect(screen, color, (x, y, width, height))
        elif shape == "ellipse":
            pygame.draw.ellipse(screen, color, (x, y, width, height))

        # Update the display
        pygame.display.flip()

        # Generate a sound
        sound_generator.generate_sound()

        # Check if the duration has elapsed
        if time.time() - start_time > DURATION:
            stop_flag = True

# Start the program
start_time = time.time()
main_loop()

# Stop the sound generator
sound_generator.stop()

# Quit Pygame
pygame.quit()
